@page "/signup"
@using MarketplaceBlazor.DtoModels
@inject HttpClient Client
@inject NavigationManager NavigationManager


@if (IsLoading)
{
    <div class="spinner-border text-primary" role="status">
       
    </div>
}
@*else if (UserDto is null)
{
   <h1 style="color: red"><em>No information found yet...</em></h1>
}*@

else
{
    <div class="d-flex justify-content-center" style="flex-wrap:wrap;">
        <div class="form-group row g-3 col-md-5" style="border-radius: 25px;
    margin-top: 1rem;
    padding: 2rem;
    box-shadow: 0 0rem 3rem rgba(8,7,16,0.6)!important;">

        <EditForm Model="@_userDto" OnValidSubmit="@CreateUser" >
            <DataAnnotationsValidator/>
            <ValidationSummary/>
            <h1 class="col-12" style="text-align:center">Sign Up </h1>
            <label for="name">Name:</label>
                <InputText placeholder="Name" id="name" class="form-control" @bind-Value="@_userDto.Name"/>
           

                <label for="username">Userame:</label>
            <InputText placeholder="Username" id="username" class="form-control" @bind-Value="@_userDto.Username" />

                <label for="password">Password:</label>
                <InputText placeholder="Password" id="Passwordassword" class="form-control" @bind-Value="@_userDto.Password" />
            


            <br/>
            <button type="submit" class="btn btn-primary">Register</button>
            <br/><br/>
         

        </EditForm>
        </div>
    </div>
}


@code {
    private bool IsLoading { get; set; } = false;
    private readonly UserDto _userDto = new();
    
    public async Task CreateUser()
    {
        IsLoading = true;
        await Client.PostAsJsonAsync("/api/signup", _userDto);
        IsLoading = false;

        NavigationManager.NavigateTo("/profile");
    }

}

